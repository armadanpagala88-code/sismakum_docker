# SISMAKUM - Root .htaccess
# File ini mengarahkan request ke index.php di root

<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /

    # Handle Authorization Header
    RewriteCond %{HTTP:Authorization} .
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

    # API requests - pass to Laravel backend
    RewriteCond %{REQUEST_URI} ^/api
    RewriteRule ^api/(.*)$ backend/public/index.php [L,QSA]

    # Storage files - pass to Laravel backend
    RewriteCond %{REQUEST_URI} ^/storage
    RewriteRule ^storage/(.*)$ backend/public/storage/$1 [L]

    # Static files from frontend dist (if exists)
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteCond %{REQUEST_URI} \.(js|css|png|jpg|jpeg|gif|svg|ico|woff|woff2|ttf|eot|json)$ [NC]
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteRule ^(.*)$ $1 [L]

    # All other requests - pass to root index.php
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php [L,QSA]
</IfModule>

# Security: Deny access to sensitive files
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

# Prevent directory listing
Options -Indexes

# Set default charset
AddDefaultCharset UTF-8
